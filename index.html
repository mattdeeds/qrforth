<!DOCTYPE html>
<html lang="en-US">
<head>
  <title>qrforth</title>
  <meta charset="utf-8" />
  <!-- <script type="module">
    import init, { forth } from "./pkg/qrforth.js";
      init().then(() => {
        forth("400 20 +");
      });
  </script> -->
</head>
<body>
  <div>
    <h1>qrforth</h1>
    <div id="terminal">
        <pre id="output"></pre>
        <input id="input" type="text" autofocus>
    </div>
  </div>
  <br>
  <footer>qrforth v0.1.0, 2023 mdeeds, MIT License</footer>
  <script type="module">

    const importObj = {};
    const response = await fetch("target/wasm32-unknown-unknown/release/qrforth.wasm");
    const {instance} = 
      await WebAssembly.instantiateStreaming(response, importObj);

    let top = instance.exports.nth_prime(3)

    const terminal = document.getElementById('terminal');
    const output = document.getElementById('output');
    const input = document.getElementById('input');

    input.addEventListener('keyup', function (e) {
        if (e.key === 'Enter') {
            e.preventDefault();
            const command = input.value;
            input.value = '';
            appendOutput(`${command}`);
            executeCommand(command);
        }
    });

    function appendOutput(text) {
        output.innerHTML += text + '\n';
        terminal.scrollTop = terminal.scrollHeight; // Auto-scroll to the bottom
    }

    function executeCommand(command) {
      //wasmMemory[tokenPointer + 1] = 55;
      appendOutput(`${top}`);
    }
    
    </script>
</body>
</html>